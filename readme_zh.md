# MIKE简易导入横断面程序

该程序旨在简化将横断面数据导入MIKE软件的过程。它主要包含两个部分：`part1.sh` 和 `part2.sh`，在这两部分之间需要进行手动操作。

## 概览

- `part1.sh`：将.xlsx文件转换为.csv，重命名并整理这些文件，并提取链长数据。
- `part2.sh`：将链长数据插入.csv文件，清洁并将这些文件转换为.txt，处理虚拟横断面，并将所有.txt文件合并为一个。

## 前提条件

- 系统上安装了Python。
- 正确格式化的输入.xlsx文件和一个`chainage.csv`文件。

## 安装

克隆仓库或将脚本下载到您的本地机器上。

## 使用方法

### 第一部分：初始数据准备

1. **转换XLSX至CSV并提取链长**
   运行`part1.sh`以将.xlsx文件转换为.csv，复制相关.csv文件，重命名它们，并提取链长数据。

   ```bash
   ./part1.sh
   ```

### 手动操作

完成第一部分后，您需要手动进行以下操作：

1. **在`chainage.csv`中标记横断面名称**：识别并标记横断面的名称。
2. **根据河流名称分离数据**：根据`chainage.csv`中的河流名称，将数据分割到`00_chg_files`目录中相应的`_chg.csv`文件中。

### 第二部分：最终数据处理和合并

1. **插入链长并处理数据**
   运行`part2.sh`以插入链长数据，清理.csv文件，将它们转换为.txt，处理虚拟横断面，并将所有.txt文件合并。

   ```bash
   ./part2.sh
   ```

## 脚本描述

### `part1.sh`

- 📂 移动到脚本目录。
- 🔄 将.xlsx文件转换为.csv。
- 📁 创建csv部分目录并复制相关文件。
- ✏️ 重命名.csv文件。
- 📊 提取链长数据。

### `part2.sh`

- 📂 更改目录至`00_scripts`。
- 🔗 将链长数据插入.csv文件。
- 🧹 清理CSV文件。
- 🔄 将CSV文件转换为TXT。
- 🚀 处理虚拟起始横断面。
- 🏁 管理虚拟结束横断面。
- 🔄 更新虚拟结束横断面。
- 📚 将所有TXT文件合并为一个`combined.txt`。

## 注意事项

- 确保所有文件路径和名称正确设置，以符合您的目录结构。
- 为使脚本正确运行，准确进行手动步骤至关重要。

## 贡献

欢迎您克隆仓库并提交任何改进或错误修复的拉取请求。

## 许可

MIT

## 联系方式

zengtianli1@126.com
